/******************************************************************************/
/***          Generated by IBExpert 2017.7.2.1 11/08/2017 14:54:09          ***/
/******************************************************************************/

CREATE DOMAIN D$BOOL AS
BOOLEAN;

CREATE DOMAIN D$CHAR_1 AS 
CHAR(1);

CREATE DOMAIN D$CODE AS 
INTEGER;

CREATE DOMAIN D$DATE AS 
DATE;

CREATE DOMAIN D$ID AS 
INTEGER
NOT NULL;

CREATE DOMAIN D$NUMERIC_18_4 AS 
NUMERIC(18,4);

CREATE DOMAIN D$NUMERIC_5_2 AS 
NUMERIC(5,2);

CREATE DOMAIN D$STR_10 AS 
VARCHAR(10) CHARACTER SET WIN1251
COLLATE PXW_CYRL;

CREATE DOMAIN D$STR_100 AS 
VARCHAR(100) CHARACTER SET WIN1251
COLLATE PXW_CYRL;

CREATE DOMAIN D$STR_20 AS 
VARCHAR(20) CHARACTER SET WIN1251
COLLATE PXW_CYRL;

CREATE DOMAIN D$STR_30 AS 
VARCHAR(30) CHARACTER SET WIN1251
COLLATE PXW_CYRL;

CREATE DOMAIN D$STR_50 AS 
VARCHAR(50) CHARACTER SET WIN1251
COLLATE PXW_CYRL;

CREATE TABLE ATTRSREF (
    ATTRID D$STR_20 NOT NULL,
    ATTRFULLNAME D$STR_100 NOT NULL,
    ATTRTYPE D$CHAR_1 NOT NULL);

DESCRIBE TABLE ATTRSREF
'Справочник атрибутов';

DESCRIBE FIELD ATTRID TABLE ATTRSREF
'Код атрибута';

DESCRIBE FIELD ATTRFULLNAME TABLE ATTRSREF
'Наименование атрибута';

DESCRIBE FIELD ATTRTYPE TABLE ATTRSREF
'Тип атрибута';

CREATE TABLE BANKS (
    BANKID D$ID NOT NULL,
    BANKNAME D$STR_100 NOT NULL,
    BANKADDRESS D$STR_100,
    BIC D$STR_20);

DESCRIBE TABLE BANKS
'Справочник банков';

CREATE TABLE BUDGETSKINDREF (
    BUDGETKINDID D$ID generated by default as identity NOT NULL,
    BUDGETKINDNAME D$STR_50 NOT NULL);

DESCRIBE TABLE BUDGETSKINDREF
'Справочник видов финансирования';

CREATE TABLE CLIENTKINDSREF (
    CLIENTKINDID D$ID generated by default as identity NOT NULL,
    CLIENTKINDNAME D$STR_100 NOT NULL);

DESCRIBE TABLE CLIENTKINDSREF
'Справочник видов клиентов';

DESCRIBE FIELD CLIENTKINDID TABLE CLIENTKINDSREF
'Идентификатор вида клиента';

DESCRIBE FIELD CLIENTKINDNAME TABLE CLIENTKINDSREF
'Наименование вида клиента';

CREATE TABLE CLIENTS (
    CLIENTID D$ID generated by default as identity NOT NULL,
    CLIENTNAME D$STR_100 NOT NULL,
    CLIENTADDRESS D$STR_100,
    ACCOUNT D$STR_30,
    UNN D$STR_10,
    CLIENTKINDID D$CODE NOT NULL,
    MINISTRYID D$CODE,
    BUDGETKINDID D$CODE,
    BANKID D$CODE,
    ISDELETED D$BOOL DEFAULT FALSE);

DESCRIBE TABLE CLIENTS
'Картотека клиентов';

DESCRIBE FIELD CLIENTID TABLE CLIENTS
'Идентификационный номер клиента';

DESCRIBE FIELD CLIENTNAME TABLE CLIENTS
'Наименование клиента';

DESCRIBE FIELD CLIENTADDRESS TABLE CLIENTS
'Адрес клиента';

DESCRIBE FIELD ACCOUNT TABLE CLIENTS
'Расчетный счет';

DESCRIBE FIELD UNN TABLE CLIENTS
'УНН';

DESCRIBE FIELD CLIENTKINDID TABLE CLIENTS
'Вид клиента';

DESCRIBE FIELD MINISTRYID TABLE CLIENTS
'Код министерства';

DESCRIBE FIELD BUDGETKINDID TABLE CLIENTS
'Вид финансирвания';

DESCRIBE FIELD BANKID TABLE CLIENTS
'Код банка';

DESCRIBE FIELD ISDELETED TABLE CLIENTS
'Признак удаления';

CREATE TABLE COMMONSREF (
    COMMONID D$ID generated by default as identity NOT NULL,
    COMMONNAME D$STR_100 NOT NULL,
    COMMONTABLENAME D$STR_50 NOT NULL);

DESCRIBE TABLE COMMONSREF
'Классификатор';

CREATE TABLE CONSUMERATTRS (
    CONSUMERATTRID D$ID generated by default as identity NOT NULL,
    ATTRID D$STR_20 NOT NULL,
    CONSUMERID D$CODE NOT NULL,
    VALUEDATE D$DATE DEFAULT CURRENT_DATE NOT NULL,
    SVALUE D$STR_100,
    NVALUE D$NUMERIC_18_4,
    DVALUE D$DATE);

DESCRIBE TABLE CONSUMERATTRS
'Атрибуты потребителей';

CREATE TABLE CONSUMERS (
    CONSUMERID D$ID generated by default as identity NOT NULL,
    CONSUMERNAME D$STR_100 NOT NULL,
    CLIENTID D$CODE NOT NULL,
    ISHOUSINGSTOCK D$BOOL,
    LOCALITYID D$CODE);

DESCRIBE TABLE CONSUMERS
'Картотека потребителей';

DESCRIBE FIELD CONSUMERID TABLE CONSUMERS
'Код потребителя';

DESCRIBE FIELD CONSUMERNAME TABLE CONSUMERS
'Наименование потребителя';

DESCRIBE FIELD CLIENTID TABLE CONSUMERS
'Код клиента';

DESCRIBE FIELD ISHOUSINGSTOCK TABLE CONSUMERS
'Признак жилфонда';

DESCRIBE FIELD LOCALITYID TABLE CONSUMERS
'Код населенного пункта';

CREATE TABLE CONSUMERSERVS (
    CONSUMERSERVID D$ID generated by default as identity NOT NULL,
    CONSUMERID D$CODE NOT NULL,
    SERVID D$CODE NOT NULL,
    PRODUCTSITEID D$CODE NOT NULL,
    COUNTERID D$CODE,
    ISACTIVE D$BOOL DEFAULT TRUE);

DESCRIBE TABLE CONSUMERSERVS
'Виды услуг по потребителям';

CREATE TABLE COUNTERKINDSREF (
    COUNTERKINDID D$ID generated by default as identity NOT NULL,
    COUNTERKINDNAME D$STR_50);

DESCRIBE TABLE COUNTERKINDSREF
'Справочник видов приборов учета';

CREATE TABLE COUNTERS (
    COUNTERID D$ID generated by default as identity NOT NULL,
    COUNTERNAME D$STR_50,
    CLIENTID D$CODE,
    COUNTERKINDID D$CODE,
    ISGROUPCOUNTER D$BOOL);

DESCRIBE TABLE COUNTERS
'Приборы учета';

CREATE TABLE FUELNORMS (
    FUELNORMID D$ID generated by default as identity NOT NULL,
    PRODUCTSITEID D$CODE NOT NULL,
    FUELID D$CODE NOT NULL,
    FUELNORMVAL D$NUMERIC_18_4);

DESCRIBE TABLE FUELNORMS
'Нормы расхода топлива';

CREATE TABLE FUELSREF (
    FUELID D$ID generated by default as identity NOT NULL,
    FUELNAME D$STR_50 NOT NULL,
    CONVERTRATIO D$NUMERIC_18_4);

DESCRIBE TABLE FUELSREF
'Виды топлива';

CREATE TABLE HEATINGCHARACTERSREF (
    HEATCHARID D$ID generated by default as identity NOT NULL,
    VOLUME_FROM D$CODE,
    VOLUME_TO D$CODE,
    Q_NEW_K D$NUMERIC_18_4,
    Q_NEW_D D$NUMERIC_18_4,
    Q_OLD$K D$NUMERIC_18_4,
    Q_OLD$D D$NUMERIC_18_4);

DESCRIBE TABLE HEATINGCHARACTERSREF
'Отопительные характеристики';

CREATE TABLE HOUSEATTRS (
    HOUSEATTRID D$ID generated by default as identity NOT NULL,
    HOUSEID D$CODE NOT NULL,
    ATTRID D$STR_20 NOT NULL,
    VALUEDATE D$DATE NOT NULL,
    SVALUE D$STR_100,
    NVALUE D$NUMERIC_18_4,
    DVALUE D$DATE);

DESCRIBE TABLE HOUSEATTRS
'Атрибуты домов';

CREATE TABLE HOUSES (
    HOUSEID D$ID generated by default as identity NOT NULL,
    PRODUCTSITEID D$CODE NOT NULL,
    LOCALITYID D$CODE,
    STREETID D$CODE,
    HOUSENUM D$STR_10,
    HCOUNTERID D$CODE,
    HWCOUNTERID D$CODE,
    CWCOUNTERID D$CODE,
    ISHEAT D$BOOL,
    ISHOTWATER D$BOOL);

DESCRIBE TABLE HOUSES
'Дома';

CREATE TABLE LOCALITIESREF (
    LOCALITYID D$ID generated by default as identity NOT NULL,
    LOCALITYNAME D$STR_100 NOT NULL,
    LOCALITYCOUNCIL D$STR_100);

DESCRIBE TABLE LOCALITIESREF
'Справочник населенных пунктов';

DESCRIBE FIELD LOCALITYID TABLE LOCALITIESREF
'Идентификатор населенного пункта';

DESCRIBE FIELD LOCALITYNAME TABLE LOCALITIESREF
'Наименование населенного пункта';

DESCRIBE FIELD LOCALITYCOUNCIL TABLE LOCALITIESREF
'Сельсовет';

CREATE TABLE LOCATIONTYPESREF (
    LOCATIONTYPEID D$ID generated by default as identity NOT NULL,
    LOCATIONTYPENAME D$STR_50);

DESCRIBE TABLE LOCATIONTYPESREF
'Справочник местоположений';

CREATE TABLE MINISTRIESREF (
    MINISTRYID D$ID generated by default as identity NOT NULL,
    MINISTRYNAME D$STR_50 NOT NULL);

DESCRIBE TABLE MINISTRIESREF
'Справочник министерств';

CREATE TABLE PRODUCTSITEATTRS (
    PRODUCTSITEATTRID D$ID generated by default as identity NOT NULL,
    ATTRID D$STR_20 NOT NULL,
    PRODUCTSITEID D$CODE NOT NULL,
    VALUEDATE D$DATE,
    SVALUE D$STR_100,
    NVALUE D$NUMERIC_18_4,
    DVALUE D$DATE);

DESCRIBE TABLE PRODUCTSITEATTRS
'Атрибуты производственных участков';

CREATE TABLE PRODUCTSITES (
    PRODUCTSITEID D$ID generated by default as identity NOT NULL,
    PRODUCTSITENAME D$STR_50,
    LOCATIONTYPEID D$CODE,
    CHIEF D$STR_50,
    COUNTERID D$CODE);

DESCRIBE TABLE PRODUCTSITES
'Справочник производственных участков';

CREATE TABLE SERVICEKINDSREF (
    SERVICEKINDID D$ID generated by default as identity NOT NULL,
    SERVICEKINDNAME D$STR_100 NOT NULL);

DESCRIBE TABLE SERVICEKINDSREF
'Справочник видов услуг';

CREATE TABLE STREETSREF (
    STREETID D$ID generated by default as identity NOT NULL,
    STREETNAME D$STR_100);

DESCRIBE TABLE STREETSREF
'Справочник улиц';

CREATE TABLE TARIFFSERVS (
    SERVID D$ID generated by default as identity NOT NULL,
    SERVTITLE D$STR_50 NOT NULL,
    SERVICEKINDID D$CODE NOT NULL,
    VATID D$CODE);

DESCRIBE TABLE TARIFFSERVS
'Справочник тарифов по видам услуг';

CREATE TABLE TARIFFSERVSVAL (
    SERVID D$CODE NOT NULL,
    DATEFROM D$DATE NOT NULL,
    TARIFFVALUE D$NUMERIC_18_4 NOT NULL);

DESCRIBE TABLE TARIFFSERVSVAL
'Тарифы';

CREATE TABLE VATSREF (
    VATID D$ID generated by default as identity NOT NULL,
    VATNAME D$STR_50,
    VATVALUE D$NUMERIC_5_2);

DESCRIBE TABLE VATSREF
'Справочник расчетов НДС';

CREATE INDEX IDX_BANKS_BIC
ON BANKS (BIC);

CREATE UNIQUE INDEX IDX_CONSUMERSATTR_UNIQ
ON CONSUMERATTRS (ATTRID, CONSUMERID, VALUEDATE);

CREATE UNIQUE INDEX IDX_PRODUCTSITEATTR_UNQ
ON PRODUCTSITEATTRS (ATTRID, PRODUCTSITEID, VALUEDATE);

ALTER TABLE ATTRSREF ADD CONSTRAINT PK_ATTRSREF PRIMARY KEY (ATTRID);

ALTER TABLE BANKS ADD CONSTRAINT PK_BANKS PRIMARY KEY (BANKID);

ALTER TABLE BUDGETSKINDREF ADD CONSTRAINT PK_BUDGETSKINDREF PRIMARY KEY (BUDGETKINDID);

ALTER TABLE CLIENTKINDSREF ADD CONSTRAINT PK_CLIENTSKINDREF PRIMARY KEY (CLIENTKINDID);

ALTER TABLE CLIENTS ADD CONSTRAINT PK_CLIENTS PRIMARY KEY (CLIENTID);

ALTER TABLE COMMONSREF ADD CONSTRAINT PK_COMMONSREF PRIMARY KEY (COMMONID);

ALTER TABLE CONSUMERATTRS ADD CONSTRAINT PK_CONSUMERSATTR PRIMARY KEY (CONSUMERATTRID);

ALTER TABLE CONSUMERS ADD CONSTRAINT PK_CONSUMERS PRIMARY KEY (CONSUMERID);

ALTER TABLE CONSUMERSERVS ADD CONSTRAINT PK_CONSUMERSERVS PRIMARY KEY (CONSUMERSERVID);

ALTER TABLE COUNTERKINDSREF ADD CONSTRAINT PK_COUNTERSKINDREF PRIMARY KEY (COUNTERKINDID);

ALTER TABLE COUNTERS ADD CONSTRAINT PK_COUNTERS PRIMARY KEY (COUNTERID);

ALTER TABLE FUELNORMS ADD CONSTRAINT PK_FUELNORMS PRIMARY KEY (FUELNORMID);

ALTER TABLE FUELSREF ADD CONSTRAINT PK_FUELSREF PRIMARY KEY (FUELID);

ALTER TABLE HEATINGCHARACTERSREF ADD CONSTRAINT PK_HEATINGCHARACTERS PRIMARY KEY (HEATCHARID);

ALTER TABLE HOUSEATTRS ADD CONSTRAINT PK_HOUSEATTRS PRIMARY KEY (HOUSEATTRID);

ALTER TABLE HOUSES ADD CONSTRAINT PK_HOUSES PRIMARY KEY (HOUSEID);

ALTER TABLE LOCALITIESREF ADD CONSTRAINT PK_LOCALITIESREF PRIMARY KEY (LOCALITYID);

ALTER TABLE LOCATIONTYPESREF ADD CONSTRAINT PK_LOCATIONSTYPEREF PRIMARY KEY (LOCATIONTYPEID);

ALTER TABLE MINISTRIESREF ADD CONSTRAINT PK_MINISTRIESREF PRIMARY KEY (MINISTRYID);

ALTER TABLE PRODUCTSITEATTRS ADD CONSTRAINT PK_PRODUCTSITEATTRS PRIMARY KEY (PRODUCTSITEATTRID);

ALTER TABLE PRODUCTSITES ADD CONSTRAINT PK_PRODUCTSITES PRIMARY KEY (PRODUCTSITEID);

ALTER TABLE SERVICEKINDSREF ADD CONSTRAINT PK_SERVICESKINDREF PRIMARY KEY (SERVICEKINDID);

ALTER TABLE STREETSREF ADD CONSTRAINT PK_STREETSREF PRIMARY KEY (STREETID);

ALTER TABLE TARIFFSERVS ADD CONSTRAINT PK_TARIFFSERVS PRIMARY KEY (SERVID);

ALTER TABLE TARIFFSERVSVAL ADD CONSTRAINT PK_TARIFFSERVSVAL PRIMARY KEY (SERVID, DATEFROM);

ALTER TABLE VATSREF ADD CONSTRAINT PK_VATSREF PRIMARY KEY (VATID);

ALTER TABLE CLIENTS ADD CONSTRAINT FK_CLIENTS_CLIENTSKIND FOREIGN KEY (CLIENTKINDID) REFERENCES CLIENTKINDSREF (CLIENTKINDID);

ALTER TABLE CLIENTS ADD CONSTRAINT FK_CLIENTS_MINISTRIES FOREIGN KEY (MINISTRYID) REFERENCES MINISTRIESREF (MINISTRYID);

ALTER TABLE CLIENTS ADD CONSTRAINT FK_CLIENTS_BUDGETSKIND FOREIGN KEY (BUDGETKINDID) REFERENCES BUDGETSKINDREF (BUDGETKINDID);

ALTER TABLE CLIENTS ADD CONSTRAINT FK_CLIENTS_BANKS FOREIGN KEY (BANKID) REFERENCES BANKS (BANKID);

ALTER TABLE CONSUMERATTRS ADD CONSTRAINT FK_CONSUMERSATTR_ATTRS FOREIGN KEY (ATTRID) REFERENCES ATTRSREF (ATTRID) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE CONSUMERATTRS ADD CONSTRAINT FK_CONSUMERSATTR_CONSUMER FOREIGN KEY (CONSUMERID) REFERENCES CONSUMERS (CONSUMERID) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE CONSUMERS ADD CONSTRAINT FK_CONSUMERS_CLIENTS FOREIGN KEY (CLIENTID) REFERENCES CLIENTS (CLIENTID) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE CONSUMERS ADD CONSTRAINT FK_CONSUMERS_LOCALITIES FOREIGN KEY (LOCALITYID) REFERENCES LOCALITIESREF (LOCALITYID);

ALTER TABLE CONSUMERSERVS ADD CONSTRAINT FK_CONSUMERSERVS_COUNTERS FOREIGN KEY (COUNTERID) REFERENCES COUNTERS (COUNTERID);

ALTER TABLE CONSUMERSERVS ADD CONSTRAINT FK_CONSUMERSERVS_PRODUCTSITES FOREIGN KEY (PRODUCTSITEID) REFERENCES PRODUCTSITES (PRODUCTSITEID);

ALTER TABLE CONSUMERSERVS ADD CONSTRAINT FK_CONSUMERSERVS_TARIFFSERVS FOREIGN KEY (SERVID) REFERENCES TARIFFSERVS (SERVID);

ALTER TABLE CONSUMERSERVS ADD CONSTRAINT FK_CONSUMERSERVS_CONSUMERS FOREIGN KEY (CONSUMERID) REFERENCES CONSUMERS (CONSUMERID) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE COUNTERS ADD CONSTRAINT FK_COUNTERS_COUNTERSKIND FOREIGN KEY (COUNTERKINDID) REFERENCES COUNTERKINDSREF (COUNTERKINDID);

ALTER TABLE COUNTERS ADD CONSTRAINT FK_COUNTERS_CLIENTS FOREIGN KEY (CLIENTID) REFERENCES CLIENTS (CLIENTID);

ALTER TABLE FUELNORMS ADD CONSTRAINT FK_FUELNORMS_PRODUCTSITES FOREIGN KEY (PRODUCTSITEID) REFERENCES PRODUCTSITES (PRODUCTSITEID) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE FUELNORMS ADD CONSTRAINT FK_FUELNORMS_FUELSREF FOREIGN KEY (FUELID) REFERENCES FUELSREF (FUELID) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE HOUSEATTRS ADD CONSTRAINT FK_HOUSEATTRS_HOUSES FOREIGN KEY (HOUSEID) REFERENCES HOUSES (HOUSEID);

ALTER TABLE HOUSEATTRS ADD CONSTRAINT FK_HOUSEATTRS_ATTRS FOREIGN KEY (ATTRID) REFERENCES ATTRSREF (ATTRID);

ALTER TABLE HOUSES ADD CONSTRAINT FK_HOUSES_STREETSREF FOREIGN KEY (STREETID) REFERENCES STREETSREF (STREETID);

ALTER TABLE HOUSES ADD CONSTRAINT FK_HOUSES_PRODUCTSITES FOREIGN KEY (PRODUCTSITEID) REFERENCES PRODUCTSITES (PRODUCTSITEID);

ALTER TABLE HOUSES ADD CONSTRAINT FK_HOUSES_LOCALITIESREF FOREIGN KEY (LOCALITYID) REFERENCES LOCALITIESREF (LOCALITYID);

ALTER TABLE HOUSES ADD CONSTRAINT FK_HOUSES_COUNTERS1 FOREIGN KEY (HCOUNTERID) REFERENCES COUNTERS (COUNTERID);

ALTER TABLE HOUSES ADD CONSTRAINT FK_HOUSES_COUNTERS2 FOREIGN KEY (HWCOUNTERID) REFERENCES COUNTERS (COUNTERID);

ALTER TABLE HOUSES ADD CONSTRAINT FK_HOUSES_COUNTERS3 FOREIGN KEY (CWCOUNTERID) REFERENCES COUNTERS (COUNTERID);

ALTER TABLE PRODUCTSITEATTRS ADD CONSTRAINT FK_PRODUCTSITEATTRS_PRODUCTSITE FOREIGN KEY (PRODUCTSITEID) REFERENCES PRODUCTSITES (PRODUCTSITEID) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE PRODUCTSITES ADD CONSTRAINT FK_PRODUCTSITES_COUNTERS FOREIGN KEY (COUNTERID) REFERENCES COUNTERS (COUNTERID);

ALTER TABLE PRODUCTSITES ADD CONSTRAINT FK_PRODUCTSITES_LOCATIONTYPES FOREIGN KEY (LOCATIONTYPEID) REFERENCES LOCATIONTYPESREF (LOCATIONTYPEID);

ALTER TABLE TARIFFSERVS ADD CONSTRAINT FK_TARIFFSERVS_SERVSKIND FOREIGN KEY (SERVICEKINDID) REFERENCES SERVICEKINDSREF (SERVICEKINDID);

ALTER TABLE TARIFFSERVS ADD CONSTRAINT FK_TARIFFSERVS_VATS FOREIGN KEY (VATID) REFERENCES VATSREF (VATID);

ALTER TABLE TARIFFSERVSVAL ADD CONSTRAINT FK_TARIFFSERVSVAL_TARIFFSERVS FOREIGN KEY (SERVID) REFERENCES TARIFFSERVS (SERVID) ON DELETE CASCADE ON UPDATE CASCADE;

